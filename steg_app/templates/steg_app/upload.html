{% extends "steg_app/base.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block nav %}
    <li class="col-7">
        <form method="post" action="{% url 'upload' %}" class="row d-flex align-items-center" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form.url }}
            <button class="col-auto" type="submit">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <rect width="24" height="24" fill="none"/>
                    <path fill="none" stroke="#0078d7" stroke-linecap="round" stroke-width="1.9" d="m21 21l-3.5-3.5M17 10a7 7 0 1 1-14 0a7 7 0 0 1 14 0Z"/>
                </svg>
            </button>
        </form>
    </li>
    <li class="col-2"><a class="nav-link text-center" href="#HowItWorks">Comment ça marche ?</a></li>
{% endblock %}

{% block main %}
    <main class="container mt-5">
    <!-- petit texte accrocheur pour les images -->

        <section class="upload glass-card mt-5 mx-2 py-4 px-4 rounded ">
            <ul class=" row d-flex align-items-center ul justify-content-around list-style-none">
                <li class="flag col-auto col-lg-4 row align-items-center">
                    <img src="{% static 'ressources/stegosolve.png' %}" alt="" srcset="">
                    {% if form.non_field_errors %}
                        <ul class="alert alert-danger mt-1 mx-0" role="alert">
                            {{ form.non_field_errors }}
                        </ul>
                    {% endif %}
                </li>
                <li class="col-auto col-lg-8">
                    <form class="row justify-content-center px-5" action="{% url 'upload' %}" method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <ul class="row d-flex align-items-center list-style-none justify-content-between">
                            <li class="col-auto col-lg-8 row align-items-center">
                                <div class="d-flex align-items-center mt-5 mb-3">
                                <svg class="mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                    <rect width="24" height="24" fill="none"/><path fill="#0078d7" d="M15.729 3.884c1.434-1.44 3.532-1.47 4.693-.304c1.164 1.168 1.133 3.28-.303 4.72l-2.423 2.433a.75.75 0 0 0 1.062 1.059l2.424-2.433c1.911-1.919 2.151-4.982.303-6.838c-1.85-1.857-4.907-1.615-6.82.304L9.819 7.692c-1.911 1.919-2.151 4.982-.303 6.837a.75.75 0 1 0 1.063-1.058c-1.164-1.168-1.132-3.28.303-4.72z"/>
                                    <path fill="#0078d7" d="M14.485 9.47a.75.75 0 0 0-1.063 1.06c1.164 1.168 1.133 3.279-.303 4.72l-4.847 4.866c-1.435 1.44-3.533 1.47-4.694.304c-1.164-1.168-1.132-3.28.303-4.72l2.424-2.433a.75.75 0 0 0-1.063-1.059l-2.424 2.433c-1.911 1.92-2.151 4.982-.303 6.838c1.85 1.858 4.907 1.615 6.82-.304l4.847-4.867c1.911-1.918 2.151-4.982.303-6.837"/>
                                </svg>
                                {{ form.url }}
                                </div>
                                <label for="file" class="mb-3">
                                    <ul class="d-flex align-items-center">
                                        <li>
                                            <div class="d-flex align-items-center me-0">
                                                    <svg class="mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                                        <rect width="24" height="24" fill="none"/>
                                                        <path fill="#0078d7" d="M6 20q-.825 0-1.412-.587T4 18v-2q0-.425.288-.712T5 15t.713.288T6 16v2h12v-2q0-.425.288-.712T19 15t.713.288T20 16v2q0 .825-.587 1.413T18 20zm5-12.15L9.125 9.725q-.3.3-.712.288T7.7 9.7q-.275-.3-.288-.7t.288-.7l3.6-3.6q.15-.15.325-.212T12 4.425t.375.063t.325.212l3.6 3.6q.3.3.288.7t-.288.7q-.3.3-.712.313t-.713-.288L13 7.85V15q0 .425-.288.713T12 16t-.712-.288T11 15z"/>
                                                    </svg>
                                                    {{ form.file }}
                                            </div>
                                        </li>
                                        <li class="mb-3"><span>Parcourir</span></li>
                                    </ul>
                                </label>
                            
                                <hr class="position-center mb-5">
                                <div class="d-flex justify-content-around">
                                    {{ form.password }}
                                </div>
                                <label for="wordlist" class="mb-3">
                                    <ul class="d-flex px-0 align-items-center">
                                        <li class="mx-0">
                                            {{ form.file_wordlist }}
                                        </li>
                                        <li class="mb-3"><span>Parcourir</span></li>
                                    </ul>
                                </label>
                                <br> 
                                <button type="submit" class="btn text-light mb-3">Analyser</button>
                            </li>
                            <li class="col-auto col-lg-4">
                                <ul>
                                    <li class="form-check">
                                        <pre>{{ form.exif }} Exiftool</pre>
                                    </li>
                                    <li class="form-check">
                                        <pre>{{ form.metadata }} Metadata</pre>
                                    </li>
                                    <li class="form-check">
                                        <pre>{{ form.steghide }} Steghide</pre>
                                    </li>
                                    <li class="form-check">
                                        <pre>{{ form.zsteg }} Zsteg</pre>
                                    </li>
                                    <li class="form-check">
                                        <pre>{{ form.strings }} Strings</pre>
                                    </li>
                                    <li class="form-check">
                                        <pre>{{ form.stegsolve }} Stegsolve</pre>
                                    </li>
                                    <li class="form-check">
                                        <pre>{{ form.binwalk }} Binwalk</pre>
                                    </li>
                                    <li class="form-check">
                                        <pre>{{ form.foremost }} Foremost</pre>
                                    </li>
                                    <li class="form-check">
                                        <pre>{{ form.File }} File</pre>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        
                        
                    </form>
                </li>
            </ul>
        </section>
            
        
        

        
    </main>
        <section id="HowItWorks" class="bg-light mt-5 p-4 px-5">
            <h2 class="text-center">Comment ça marche ?</h2>
            <br>
            <!-- 1. Envoi de l’image -->
            <section aria-labelledby="step-1-title">
                <h2 id="step 1-title" class="text-center col_blue">Envoi de l’image</h3>
                <p class="int">Vous pouvez fournir une image de deux façons :</p>
                <ul>
                <li><strong>URL</strong> : collez l’adresse d’une image en ligne.</li>
                <li><strong>Fichier</strong> : téléversez une image depuis votre ordinateur.</li>
                </ul>
                <p class="note int" role="note">
                <strong>Important :</strong> au moins l’une des deux options (URL ou Fichier) doit être fournie. 
                Sinon, le formulaire sera refusé.
                </p>
            </section>

            <!-- 2. Options d’analyse -->
            <section aria-labelledby="step-2-title">
                <h2 id="step-2-title" class="text-center col_blue">Options d’analyse</h2>
                <p class="int">Cochez une ou plusieurs méthodes d’analyse stéganographique :</p>
                <ul>
                <li><strong>EXIF</strong> : extrait les métadonnées classiques (date, GPS, appareil, etc.).</li>
                <li><strong>Steghide</strong> : recherche de données cachées (peut utiliser un mot de passe ou une wordlist).</li>
                <li><strong>zsteg</strong> : tests de données cachées (surtout PNG, manipulation de bits).</li>
                <li><strong>strings</strong> : recherche de chaînes de texte lisibles dans le binaire.</li>
                <li><strong>Stegsolve</strong> : inspection visuelle des plans de couleur (bitplanes).</li>
                <li><strong>binwalk</strong> : détection de signatures/fichiers intégrés.</li>
                <li><strong>foremost</strong> : extraction automatique de fichiers cachés/supprimés.</li>
                <li><strong>file</strong> : identification précise du type de fichier.</li>
                <li><strong>metadata</strong> : inspection de métadonnées avancées.</li>
                </ul>
                <p class="note int" role="note">
                <strong>Important :</strong> au moins <em>une</em> méthode doit être sélectionnée pour lancer l’analyse.
                </p>
            </section>

            <!-- 3. Gestion des fichiers associés -->
            <section aria-labelledby="step-3-title">
                <h2 id="step-3-title" class="text-center col_blue">Gestion des fichiers associés</h2>
                <ul>
                <li><strong>Wordlist</strong> : si fournie, elle est sauvegardée et utilisable par <code>steghide</code>.</li>
                <li><strong>Détection du type</strong> : l’image est ouverte pour identifier son format (PNG, JPEG, …).</li>
                <li>Selon le format :
                    <ul>
                    <li><strong>PNG</strong> : l’outil <code>pngcheck</code> peut être suggéré.</li>
                    <li><strong>JPEG</strong> : l’outil <code>jpeginfo</code> peut être suggéré.</li>
                    </ul>
                </li>
                </ul>
            </section>

            <!-- 4. Résultats -->
            <section aria-labelledby="step-4-title">
                <h2 id="step-4-title" class="text-center col_blue">Résultats</h2>
                <p class="int">Après validation, l’image est enregistrée et vous êtes redirigé vers la page de résultats :</p>
                <ul>
                <li>Affichage de l’image envoyée.</li>
                <li>Exécution des outils sélectionnés.</li>
                <li>Affichage des sorties (logs, métadonnées, fichiers extraits, etc.).</li>
                </ul>
            </section>
            </section>

        </section>
   
{% endblock %}